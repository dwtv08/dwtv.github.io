
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Advanced M3U8 Player</title>
  <link rel="stylesheet" href="style.css" />
</head>
<body>

  <div class="player-container" id="playerContainer">
    <div class="logo">MyStream</div>
    <video id="video" playsinline muted></video>

    <div class="custom-controls">
      <button id="playPause">Play</button>
      <span id="currentTime">0:00</span>
      <input type="range" id="progress" value="0" step="0.1" />
      <span id="duration">0:00</span>
      <button id="mute">Unmute</button>
      <input type="range" id="volume" min="0" max="1" step="0.01" value="1" />
      <select id="qualitySelector"></select>
      <button id="fullscreen" onclick="toggleFullscreen()">Fullscreen</button>
    </div>
  </div>

  <script src="https://cdn.jsdelivr.net/npm/hls.js@latest"></script>
  <script>
    const video = document.getElementById('video');
    const playPause = document.getElementById('playPause');
    const mute = document.getElementById('mute');
    const volume = document.getElementById('volume');
    const progress = document.getElementById('progress');
    const currentTimeLabel = document.getElementById('currentTime');
    const durationLabel = document.getElementById('duration');
    const qualitySelector = document.getElementById('qualitySelector');
    const fullscreenButton = document.getElementById('fullscreen');
    const playerContainer = document.getElementById('playerContainer');

    const videoSrc = 'https://bitdash-a.akamaihd.net/content/sintel/hls/playlist.m3u8'; // mendukung multi-quality

    let hls;

    if (Hls.isSupported()) {
      hls = new Hls();
      hls.loadSource(videoSrc);
      hls.attachMedia(video);

      hls.on(Hls.Events.MANIFEST_PARSED, function (_, data) {
        qualitySelector.innerHTML = '';
        data.levels.forEach((level, i) => {
          const option = document.createElement('option');
          option.value = i;
          option.text = level.height + 'p';
          qualitySelector.appendChild(option);
        });
        qualitySelector.value = hls.currentLevel;
      });

      qualitySelector.addEventListener('change', () => {
        hls.currentLevel = parseInt(qualitySelector.value);
      });

    } else if (video.canPlayType('application/vnd.apple.mpegurl')) {
      video.src = videoSrc;
    }

    playPause.onclick = () => video.paused ? video.play() : video.pause();
    video.addEventListener('play', () => playPause.textContent = 'Pause');
    video.addEventListener('pause', () => playPause.textContent = 'Play');

    mute.onclick = () => {
      video.muted = !video.muted;
      mute.textContent = video.muted ? 'Unmute' : 'Mute';
    };

    volume.oninput = () => {
      video.volume = volume.value;
      video.muted = volume.value == 0;
      mute.textContent = video.muted ? 'Unmute' : 'Mute';
    };

    video.addEventListener('timeupdate', () => {
      progress.value = video.currentTime;
      currentTimeLabel.textContent = formatTime(video.currentTime);
    });

    video.addEventListener('loadedmetadata', () => {
      progress.max = video.duration;
      durationLabel.textContent = formatTime(video.duration);
    });

    progress.oninput = () => video.currentTime = progress.value;

    function formatTime(seconds) {
      const minutes = Math.floor(seconds / 60);
      const secs = Math.floor(seconds % 60);
      return `${minutes}:${secs < 10 ? '0' + secs : secs}`;
    }

    // Toggle fullscreen function
    function toggleFullscreen() {
      if (!document.fullscreenElement) {
        if (playerContainer.requestFullscreen) {
          playerContainer.requestFullscreen();
        } else if (playerContainer.mozRequestFullScreen) { // Firefox
          playerContainer.mozRequestFullScreen();
        } else if (playerContainer.webkitRequestFullscreen) { // Chrome, Safari
          playerContainer.webkitRequestFullscreen();
        } else if (playerContainer.msRequestFullscreen) { // IE/Edge
          playerContainer.msRequestFullscreen();
        }
      } else {
        if (document.exitFullscreen) {
          document.exitFullscreen();
        } else if (document.mozCancelFullScreen) {
          document.mozCancelFullScreen();
        } else if (document.webkitExitFullscreen) {
          document.webkitExitFullscreen();
        } else if (document.msExitFullscreen) {
          document.msExitFullscreen();
        }
      }
    }
  </script>

</body>
</html>
